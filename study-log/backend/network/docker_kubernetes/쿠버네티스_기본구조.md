# 쿠버네티스의 개념
- 대량의 컨테이너 관리 시스템

# 구조
- 쿠버네티스 클러스터
  - 마스터 노드, 워커노드, 노드 간 통신 CNI
- 컨트롤 플레인
  - 마스터 노드에서 작업 관리
  - API 서버, etcd, 스케줄러, 컨트롤러 매니저(특정 리소스 타입관리)
- 노드
  - kubelet
    - 컨테이너 실행 담당, 파드의 상태 모니터링하면서 문제시 재생성
  - Kube-Proxy
    - 내외부 네트워크
  - 컨테이너 런타임
    - 컨테이너 생명주기 담당
  - 파드
    - 변동IP   
- 워크로드
  - 쿠버네티스 상 실행되는 애플리케이션
  - 레플리카셋, 디플로이먼트, 스테이트풀셋, 데몬셋, 잡/크론잡
- 네트워크
  - 서비스: 변동 IP 신경 안 쓰고 pod와 통신ㅠ가능
  - 인그레스: 클러스터 외부와 통신 가능
- 스토리지
  - 파드 상태와 무관히 파일 보관 


# 디플로이먼트
- 가용 파드 갯수 보장하는 레플리카셋 콘트롤러
- 롤아웃(컨테이너 업데이트)/롤백



# 서비스
- 외부 트래픽 노출, 로드 밸런싱
- ClusterIP
  - 클러스터 내부에서만 접근가능한 IP 
- NodePort
  - 각 노드의 특정포트로 외부 접근 허용
- Loadbalancer
  - 외부용 로드밸런서를 생성해서 공인 IP 부여, NodePort의 상위 집합
- ExternalName
  - CNAME 레코드 통해 클러스터 외부서비스로의 DNS 조회 제공
  - 서비스가 클러스터 외부 도메인을 가리킴


# 스토리지 볼륨
- emptyDir
  - 파드 내 임시 볼륨. 파드 삭제시 같이 삭제
- hostPath
  - 노드 파일 시스템을 마운트
  - 동일 데이터를 서로 다른 파드에서 로드 가능
- PersistentVolume
  - 클러스터 관리자가 PV생성하면 사용자가 PVC 통해 PV 요청

 
# 스테이트풀셋
- 동일 스펙인 파드라도 서로가 서로 대체 불가(영구 식별자, 스케줄링시에도 유지)
- 필요한 경우
  -  안정적이고 고유한 네트워크 식별자
  -  안정적인 Persistent Storage
  -  순차적인 Graceful Deployment와 스케일링
  -  순차적/자동 롤링 업데이트
- 헤드리스 서비스
  - 파드들의 개별 네트워크 식별하기 위한 서비스


# 인그레스
- 쿠버네티스 외부에서 내부 서비스로 접근하는 HTTP(S) 라우팅 규칙 정의하는 오브젝트


# 헬름
- 다수의 yaml을 관리해야할 떄, 하나의 패키지 형태로 관리

# 잡과 크론잡
- 지정된 수의 파드가 정상종료될 때까지 재시도
- 지정 횟수만큼 성공하면 종료
- 크론잡은 반복 일정에 따라 실행
