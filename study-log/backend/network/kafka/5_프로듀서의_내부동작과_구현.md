# 파티셔너
- 해당 토픽의 어느 파티션으로 메세지를 보내야할지
- 파티션 수가 변하면 해시테이블도 변함
  - 같은 키라도 파티션이 늘면 다른 파티션으로 전송됨
 
# 파티셔닝 전략
- 라운드 로빈 전략
  - 배치전송에 필요한 레코드 수를 못 채워서 지연 
- 스티키 파티셔닝 전략
  - 한 파티션에 배치 전송 수 채워서 지연 개선
 
# 중복 없는 전송(멱등성)
- PID와 메세지 번호를 Pair로 전송
- 중복 수신 인 경우 저장 안하고 ack만 반환
- 비교 오버헤드 있긴한데 최소화함

# 정확히 한 번 전송(트랜잭션)
- 트랜잭션 코디네이터
  - 트랜잭션 로그를 카프카 내부 토픽에 저장
- 클라이언트
  - 컨트롤 메세지(메세지 정상 커밋 or not)받음
- TRANSACTION_ID_CONFIG
  - 프로듀서 **프로세스**별 고유 아이디
- 트랜잭션 과정
  - 트랜잭션 코디네이터 찾기
  - 트랜잭션 초기화 요청: 동일한 PID와 이전 에포크에 대한 쓰기 요청 무시
  - 트랜잭션 시작 알림
  - 각 트랜잭션 상태 기록
  - 메세지(PID, 에포크, 시퀀스 번호)
  - 트랜잭션 커밋/어보트 기록
