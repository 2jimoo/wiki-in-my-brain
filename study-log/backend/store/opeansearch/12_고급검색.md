# Geo Query
- ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰
- ë°ì´í„° íƒ€ì…
  - geo_point
    - ìœ„ë„(lat), ê²½ë„(lon)ë¥¼ ê°€ì§„ ë‹¨ìˆœí•œ ì  ì¢Œí‘œ
```
"location": { "lat": 37.5665, "lon": 126.9780 }
```
  - geo_shape
    - ì„ (Line), ë‹¤ê°í˜•(Polygon), ì›(Circle) ë“± ë³µì¡í•œ ë„í˜• 
```
"area": { "type": "polygon", "coordinates": [...] }
```
- ì¿¼ë¦¬
  - bounding_box
    - ì‚¬ê°í˜• ë²”ìœ„ ë‚´ ê²€ìƒ‰ 
```
{
  "query": {
    "geo_bounding_box": {
      "location": {
        "top_left": {
          "lat": 40.73,
          "lon": -74.1
        },
        "bottom_right": {
          "lat": 40.01,
          "lon": -71.12
        }
      }
    }
  }
}
```
  - geo_distance
    - ì›í˜• ë²”ìœ„ ë‚´ ê²€ìƒ‰
```{
  "query": {
    "geo_distance": {
      "distance": "20km",
      "location": {
        "lat": 37.5665,
        "lon": 126.9780
      }
    }
  }
}
```
  - geo_shape
    - ë‹¤ê°í˜• ë²”ìœ„ ë‚´ ê²€ìƒ‰
    - relationìœ¼ë¡œ ë‹¤ê°í˜• ë²”ìœ„ì™€ì˜ ê´€ê³„ ì •ì˜ ex. disjoint
```
{
  "query": {
    "geo_shape": {
      "area": {
        "shape": {
          "type": "polygon",
          "coordinates": [
            [
              [0, 0], [0, 10], [10, 10], [10, 0], [0, 0]
            ]
          ]
        },
        "relation": "within"
      }
    }
  }
}

```


# Shape Query
- ì „ìš© shape ë°ì´í„° íƒ€ì… ìƒì„±í•˜ì—¬ 2Dê°ì²´(ì ,ì„ ,ë‹¤ê°í˜•) ê°ì²´ê°„ ì¸ë±ì‹± ë° ê²€ìƒ‰
```
"mappings": {
  "properties": {
    "my_shape": {
      "type": "shape"
    }
  }
}
```
```
{
  "query": {
    "shape": {
      "my_shape": {
        "shape": {
          "type": "polygon",
          "coordinates": [
            [
              [0, 0], [0, 10], [10, 10], [10, 0], [0, 0]
            ]
          ]
        },
        "relation": "within"
      }
    }
  }
}
```

# Span Query
- í…ìŠ¤íŠ¸ í•„ë“œì—ì„œ íŠ¹ì • í† í°ë“¤ì˜ ìœ„ì¹˜(ìŠ¤íŒ¬)ì™€ ìˆœì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê²€ìƒ‰
- span_first
  - ì²˜ìŒ nê°œ í† í°ë‚´ì—ì„œ íŠ¹ì • ë‹¨ì–´ ì°¾ê¸°
```{
  "query": {
    "span_first": {
      "match": { "span_term": { "content": "quick" }},
      "end": 3
    }
  }
}
```
- span_near
  - span_term ê°„ì— slopê°œ ì´ë‚´ë¡œ ìˆê¸¸ í¬ë§í•¨
  - in_orderë¡œ ìˆœì„œ ìœ ì§€ ê°€ëŠ¥
```{
  "query": {
    "span_near": {
      "clauses": [
        { "span_term": { "content": "quick" }},
        { "span_term": { "content": "fox" }}
      ],
      "slop": 1,
      "in_order": true
    }
  }
}
```
- span_within
  - ë‘ ë‹¨ì–´ ì‚¬ì´ì˜ ë‹¨ì–´ ì°¾ì„ ë•Œ
  - little(í¬í•¨ë˜ëŠ” ë‹¨ì–´), biG(íƒìƒ‰ êµ¬ê°„ ìƒì„± ë‹¨ì–´)  
```{
  "query": {
    "span_within": {
      "big": {
        "span_near": {
          "clauses": [
            { "span_term": { "content": "start" }},
            { "span_term": { "content": "end" }}
          ],
          "slop": 10,
          "in_order": true
        }
      },
      "little": {
        "span_term": { "content": "target" }
      }
    }
  }
}
```

#  distance_feature
- ë‚ ì§œë‚˜ ìœ„ì¹˜ì— ëŒ€í•´ í˜„ì¬ ì‹œì /ìœ„ì¹˜ì™€ì˜ ê±°ë¦¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì ìˆ˜ë¥¼ ë¶€ì—¬
```
{
  "query": {
    "bool": {
      "must": { "match_all": {} },
      "should": {
        "distance_feature": {
          "field": "date",
          "origin": "now",
          "pivot": "7d"
        }
      }
    }
  }
}
```


# more_like_this
- ë¹„ìŠ·í•œ ë‚´ìš©ì„ ê°€ì§„ ë¬¸ì„œ ë°˜í™˜
```
{
  "query": {
    "more_like_this": {
      "fields": ["content"],
      "like": "The quick brown fox",
      "min_term_freq": 1,
      "max_query_terms": 12
    }
  }
}
```


# percolator
- ë¬¸ì„œë¥¼ ì¸ë±ìŠ¤ì— ë„£ê¸° ì „ì—, ì‚¬ì „ì— ë“±ë¡ëœ ì¿¼ë¦¬ì— ëŒ€í•´ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì‚¬.
- ì£¼ë¡œ ì•Œë¦¼ ì‹œìŠ¤í…œ, ì‚¬ì „ í•„í„°ë§ ë“±ì— ì‚¬ìš©
- ì¿¼ë¦¬ ë“±ë¡ í›„ ë¬¸ì„œì…‹ ì—…ë°ì´íŠ¸ ì‹œ í•´ë‹¹í•˜ëŠ” ì¿¼ë¦¬ ìˆëŠ”ì§€ ê²€ì‚¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë™ì‘

```
PUT /queries/_doc/1
{
  "query": {
    "match": { "message": "error" }
  }
}

GET /queries/_search
{
  "query": {
    "percolate": {
      "field": "query",
      "document": {
        "message": "An error occurred"
      }
    }
  }
}
```


# ğŸ“Œpinned
- íŠ¹ì • ë¬¸ì„œë¥¼ ì§€ì •ëœ ìˆœì„œë¡œ ìµœìƒë‹¨ì— ê³ ì •í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ì¼ë°˜ ì¿¼ë¦¬ 
- ê´‘ê³  ë“± ìœ„í•´ì„œ ìƒë‹¨ì— ê³ ì • 
```
{
  "query": {
    "pinned": {
      "ids": ["doc1", "doc2"],
      "organic": {
        "match": { "content": "quick fox" }
      }
    }
  }
}
```
