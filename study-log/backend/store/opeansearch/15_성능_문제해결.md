# 검색 속도 문제
- 느린 검색 쿼리, 느린 인덱싱 속도

# 느린 검색 쿼리
- 루씬 자바 힙 메모리
  - Young generation 공간을 빠르게 채우는 것을 방지하고, 가비지 수집 줄이는데 도움이 됨
- 로컬 스토리지 디스크
  - 네트워크 기반 파일시스템 및 디스크 사용보다 성능 이득 가능
- 샤드 수와 노드간 통신 트레이드 오프
- 복제본의 읽기 처리량과 메모리 소비량 트레이드 오프
- 도큐먼트 모델링
  - 비정규화; copy_to 속성을 통해 여러 필드를 합져서 단일필드 검색 제공
  - 데이터가 주로 부모-자식 관계를 가진 데이터에 부적합
- keyword
  - 풀텍스트 검색의 텍스트 분석
```
PUT /library
{
  "mappings": {
    "properties": {
      "title": { "type": "text", "copy_to": "all" },
      "author": { "type": "text", "copy_to": "all" },
      "description": { "type": "text", "copy_to": "all" },
      "all": { "type": "text" }
    }
  }
}

```
 
# 느린 인덱싱 속도
- 사용자 제공 ID는 사용시 검사과정 필요하므로 자동생성
- bulk API
- 새로고침
  - 인덱스에서 수행된 모든 작업 커밋
  - 새로고침 중지 시 최신 인덱스 도큐먼트가 검색에서 제외되나 I/O 작업 최소화
  - refresh_interval=-1로 비활성화 가능
 
# 불안정한 클러스터
- GREEN으로 유지하기
  - 하트비트, 마스터 노드
- 할당되지 않은 샤드
  - 읽기 쓰기 작업이 중단됨
  - allocation API 통해 샤드의 할당되지 않은 특성 확인 가능
 
# 디스크 사용량 임계값
- 노드 디스크 사용량이 노드 디스크 공간의
  - 85% 초과하면 해당 노드에 샤드 할당X
  - 90% 초과하면 해당 노드의 샤드 이동
  - 95% 경고 발생, 해당 노드의 모든 인덱스 사용 불가, 읽기 전용

# 서킷 브레이커
- 트리거되면 클라이언트에게 오류 발생
```
indices.breaker.total.limit: 70%
```
